# -*- coding: utf-8 -*-
"""MsDepDataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/12U-w9R4PD1ekQ_Dntwp-dj5sL7qgO-lG
"""
from torchvision import datasets
from torch.utils.data import DataLoader, Dataset , random_split
from PIL import Image
from torchvision.transforms import transforms

class MsDepDataset(Dataset):
  def __init__(self, transform = None, bg_files= None, bgfg_files= None, mask_files= None, depth_files= None):
    
    
    self.bg_files= bg_files
    self.bgfg_files= bgfg_files
    self.mask_files= mask_files
    self.depth_files= depth_files
     
    self.transform = transform
  

  def __len__(self):
    return len(self.bg_files)

  def __getitem__(self,index):
    bg_image = Image.open(self.bg_files[index])
    bgfg_image = Image.open(self.bgfg_files[index])
    mask_image = Image.open(self.mask_files[index])
    depth_image = Image.open(self.depth_files[index])
    if self.transform:
      bg_image = self.transform(bg_image)
      bgfg_image = self.transform(bgfg_image)
      mask_image = self.transform(mask_image)
      depth_image = self.transform(depth_image)
    return {'bg_image' : bg_image,'bgfg_image' : bgfg_image,'mask_image' : mask_image, 'depth_image' : depth_image }